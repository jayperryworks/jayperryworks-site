---
/**
 * Sticky note gallery block component
 * - display short passages of text in a grid of cards
 *
 * @param {StickyNote} notes - the items to display
 * @param {TitleField} [title] - optional heading to display
 * @param {FormattedText} [description] - optional descriptive blurb
 * @param {boolean} [shadow] - display shadows under the cards
 * @param {TitleField} [subtitle] - optional subheading to display
 */
// assets
import '@shared/styles/tokens/elevation.css';
import '@shared/styles/tokens/spacing.css';
import '@shared/styles/utilities/type.css';

// utilities
import * as prismicHelpers from '@prismicio/helpers';

// components
import RenderedText from '@shared/components/elements/RenderedText.astro';
import Passage from '@shared/components/blocks/Passage.astro';
import Heading from '@shared/components/blocks/Heading.astro';
import Gallery from '@shared/components/layout/Gallery.astro';
import RevealOnScroll from '@shared/components/meta/RevealOnScroll.astro';

// types
import { FormattedText, StickyNote } from '@shared/lib/types';

import { TitleField } from '@prismicio/types';

const {
	notes,
	class: className,
	title,
	description,
	shadow,
	subtitle,
} = Astro.props;

const classList = ['sticky-note-gallery', className].join(' ');
---

<section class={classList}>
	{
		prismicHelpers.isFilled.title(title) && (
			<Heading
				level={2}
				text={title}
			/>
		)
	}
	{
		prismicHelpers.isFilled.title(subtitle) && (
			<Heading
				level={4}
				text={subtitle}
				subheading
			/>
		)
	}
	{
		prismicHelpers.isFilled.richText(description) && (
			<Passage text={description} />
		)
	}
	<Gallery gutter="xnarrow">
		{
			notes.map(({ shortStatement, extendedStatement }) => (
				<li class="sticky-note-item">
					<RevealOnScroll
						class="sticky-note-text | type-role-accent type-scale-epsilon"
						tag="p"
					>
						<strong>
							<RenderedText
								markdown={shortStatement}
								inline={true}
							/>
						</strong>
						{extendedStatement && (
							<RenderedText
								markdown={extendedStatement}
								inline={true}
							/>
						)}
					</RevealOnScroll>
				</li>
			))
		}
	</Gallery>
</section>

<style>
	:global(.slide) .sticky-note-gallery {
		padding-block: var(--space-xwide);
	}

	.sticky-note-gallery {
		display: flex;
		flex-direction: column;
		gap: var(--space-medium);
	}

	.sticky-note-item {
		background-color: var(--color-island);
		border-radius: var(--border-radius);
		padding: var(--space-medium);
		transition: background-color var(--color-transition) ease-in-out;
		box-shadow: var(--elevation-xlow);
	}

	.sticky-note-item :global(p) {
		text-wrap: balance;
	}
</style>
